CREATE OR REPLACE VIEW gold_weekly_diet_summary AS
SELECT
    DATE_TRUNC('week', diet_date)::date AS week_start,

    ROUND(AVG(calories_kcal))       AS avg_calories_kcal,
    ROUND(AVG(carbs_g))             AS avg_carbs_g,
    ROUND(AVG(protein_g))           AS avg_protein_g,
    ROUND(AVG(fat_g))               AS avg_fat_g,

    ROUND(AVG(bodyweight_kg), 2)    AS avg_bodyweight_kg,

    MAX(cardio_weekly_min)          AS cardio_weekly_min,

    COUNT(*)                        AS logged_days,

    MIN(cycle_id)                   AS cycle_id
FROM diet_daily
GROUP BY week_start;